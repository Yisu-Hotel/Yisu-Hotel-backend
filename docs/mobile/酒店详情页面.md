# Yisu Hotel 移动端酒店详情页面前端流程文档

本文档描述了移动端酒店详情页面的业务逻辑流程、页面交互以及与后端的交互细节。

---

## 1. 页面初始化与数据加载

当用户从酒店列表页或广告页进入此页面时，页面将根据传递的 `hotel_id` 进行初始化。

### 1.1 核心数据请求
- **参数获取**: 从跳转参数中获取 `hotel_id`，以及可选的 `check_in_date` 和 `check_out_date`（若未传递则默认为今天和明天）。
- **接口调用**: 调用 [Hotel_API: 2.2 获取酒店详情](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Hotel_API.md#L131)。
- **数据处理**: 
    - 获取并展示酒店基础信息：名称、星级、评分、描述、联系电话、地理位置、通用政策等。
    - 获取并展示酒店关联的设施与服务。

---

## 2. 房型列表展示 (Room Types)

页面下方以卡片形式展示该酒店下的所有可用房型。

### 2.1 房型卡片内容
每个房型卡片展示以下信息：
- **基础资料**: `room_type_name` (房型名), `bed_type` (床型), `area` (面积), `description` (描述)。
- **视觉与标签**: `room_image_url` (房型图), `tags` (专属标签)。
- **配套设施**: `facilities` (房型专属设施), `services` (房型专属服务)。
- **交互逻辑**: 
    - **政策查看**: 点击房型区域可唤起弹窗，展示该房型的专属政策 `policies` (取消、支付、儿童、宠物政策等)。

### 2.2 价格展示与日期选择
每个房型卡片包含一个动态价格区域：
- **平均价格展示**: 
    - **逻辑**: 前端根据 `check_in_date` 到 `check_out_date` 之间的天数，对 `prices` 数组中对应日期的价格进行求和并取平均值。
    - **展示**: 醒目展示“日均 ¥XXX”。
- **日历价格查看**:
    - **交互**: 点击价格区域可唤起日历控件。
    - **标注逻辑**: 
        - 日历上会展示未来 30 天每日的实时价格。
        - 自动高亮标注用户当前选定的 `check_in_date` 和 `check_out_date` 区间。
    - **日期修改**: 用户可通过日历重新选择日期，修改后页面将实时重算各房型的平均价格。

---

## 3. 预订流程 (Booking Flow)

### 3.1 预订确认
- **操作**: 点击房型下方的“立即预订”按钮。
- **确认页面/弹窗**: 弹出确认页面，展示以下信息：
    - **确认信息**: 酒店名称、房型名称、入住/离店日期、总间夜数。
    - **费用明细**: 展示用户需要支付的总价（平均单价 × 天数）。
    - **特殊要求**: 提供文本输入框，用户可填写 `special_requests`。

### 3.2 创建订单
- **操作**: 用户在确认页面点击“提交订单”。
- **接口调用**: 调用 [Booking_API: 2.3 创建订单](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Booking_API.md#L205)。
- **请求参数**: 
    - `hotel_id`
    - `room_type_id`
    - `check_in_date`
    - `check_out_date`
    - `special_requests`
- **后续逻辑**:
    - **成功**: 获取返回的 `order_id`。
    - **跳转**: 自动跳转至 **支付页面**。

---

## 4. 收藏交互
- **操作**: 页面顶部设有收藏图标。
- **逻辑**: 
    - 初始化时根据 `hotel_id` 在收藏列表中匹配状态。
    - 点击可调用 [Favorite_API: 2.1 收藏](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Favorite_API.md#L21) 或 [2.2 取消收藏](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Favorite_API.md#L94) 接口。
