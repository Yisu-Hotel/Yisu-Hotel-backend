# Yisu Hotel 移动端首页前端流程文档

本文档描述了移动端首页的业务逻辑流程、页面交互以及与后端的交互细节。

---

## 1. 滚动广告栏 (Banner / Carousel)

首页最上方设有滚动广告栏，用于展示热门酒店或促销活动。

### 1.1 获取广告数据
- **接口调用**: 页面加载时调用 [Banner_API: 2.1 获取广告列表](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Banner_API.md#L21)。
- **数据处理**: 
    - 获取 `data` 数组中的广告信息。
    - 当前版本仅处理 `target_type` 为 `hotel` 的广告。

### 1.2 广告点击交互
- **操作**: 用户点击广告图片。
- **业务逻辑**:
    - 获取该广告的 `target_id`。
    - 将 `target_id` 作为 `hotel_id` 参数。
    - **跳转**: 自动跳转至 **酒店详情页面**。

---

## 2. 酒店搜索入口 (Hotel Search)

酒店搜索入口位于滚动广告栏下方，包含城市选择、日期选择及搜索触发。

### 2.1 城市定位与选择
首页左上角展示当前选中的城市，用户可在此进行城市切换。

#### A. 自动定位（选做逻辑）
- **触发时机**: 用户首次进入首页时。
- **前端逻辑**:
    1. 调用浏览器 **Geolocation API** 获取用户的当前经纬度坐标。
    2. 使用 **高德地图 API (逆地理编码)** 将经纬度转换为具体的城市名称。
    3. 在首页左上角自动展示该城市。

#### B. 手动选择城市
- **操作**: 点击左上角的城市名称。
- **跳转**: 展开 **城市列表选择页/弹窗**。
- **接口调用**: 调用 [City_API: 2.1 获取所有城市列表](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/City_API.md#L21)。
- **交互逻辑**:
    - 前端展示所有城市列表（可按拼音或排序权重分组）。
    - 用户点击目标城市后，返回首页并更新左上角显示的城市信息。

### 2.2 酒店搜索参数与筛选
搜索入口包含多个筛选维度，点击“查询”后将携带这些参数进入酒店列表页。

#### A. 核心搜索参数
- **城市选择 (`location`)**:
    - 数据来源：[2.1 城市定位与选择](#21-城市定位与选择) 中选定的城市名称。
    - 参数映射：对应 [Hotel_API: 2.1 获取酒店列表](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Hotel_API.md#L24) 的 `location` 参数。
- **日期选择 (`check_in_date` / `check_out_date`)**:
    - **默认值**: 默认为“今天”入住，“明天”离店。
    - **交互**: 用户点击日期区域可唤起日历控件进行修改。
    - **参数映射**: 对应 `check_in_date` 和 `check_out_date` 参数。
- **关键词搜索 (`keyword`)**:
    - 用户在首页搜索栏输入的文本（如酒店名、地标等）。
    - 参数映射：对应 `keyword` 参数。

#### B. 多维筛选标签
搜索栏下方展示以下筛选维度，用户可多选：
- **星级/价格**: 用户选择的目标酒店星级及预算范围。
- **评分**: 用户期望的最低评分。
- **设施/服务**: 如“含早餐”、“免费停车场”、“健身房”等。

#### C. 快速跳转标签 (Quick Jump Tags)
- **触发逻辑**: 当用户选定或切换城市后。
- **接口调用**: 调用 [Hotel_API: 2.3 获取城市热门标签与周边信息](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Hotel_API.md#L270)。
- **展示规则**:
    - 前端展示接口返回的 **10个热门标签 (`tags`)** 和 **10条周边信息 (`nearby_info`)**。
    - 这些标签以磁贴或胶囊样式展示在筛选区域下方。
- **快速跳转交互**:
    - **操作**: 用户点击任意一个热门标签或周边信息。
    - **逻辑**: 立即触发跳转，不经过手动点击“查询”按钮。
    - **携带参数**:
        - 当前已选的 `location`, `check_in_date`, `check_out_date`, `keyword` 以及各项筛选条件（星级、评分等）。
        - **点击的是标签**: 将该标签值赋给 `tags` 参数。
        - **点击的是周边信息**: 将该值赋给 `nearby_info` 参数。
    - **跳转**: 进入 **酒店列表页面**。

### 2.3 执行查询
- **操作**: 点击“查询酒店”或“开始搜索”按钮。
- **跳转逻辑**: 
    - 携带上述所有已选参数（`location`, `keyword`, `tags` 及各项筛选条件）跳转至 **酒店列表页面**。
    - 酒店列表页根据这些参数初始化并展示符合条件的酒店数据。

---

## 3. 精选酒店推荐 (Featured Hotels)

首页搜索入口下方设有精选酒店推荐区域，展示当前城市的优质酒店。

### 3.1 推荐列表加载逻辑
- **触发逻辑**: 
    - 页面初次加载（完成定位后）。
    - 用户手动切换城市后。
- **接口调用**: 调用 [Hotel_API: 2.1 获取酒店列表](file:///d:/Yisu/Yisu-Hotel-backend/docs/mobile/Hotel_API.md#L24)。
- **请求参数**: 
    - `location`: 传入当前选定的城市名称。
    - `check_in_date`: 默认为今天。
    - `check_out_date`: 默认为明天。
    - `page`: 1。
    - `pageSize`: 默认为 10（可根据 UI 需求调整）。
- **数据展示**: 
    - 首页下方列表展示接口返回的酒店简要信息（图片、名称、评分、价格等）。
    - 推荐逻辑由后端根据该城市的酒店权重或评分进行排序返回。

### 3.2 酒店详情跳转
- **操作**: 点击推荐列表中的任意酒店卡片。
- **跳转**: 跳转至 **酒店详情页面**，并传递 `hotel_id` 参数。
